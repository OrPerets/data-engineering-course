@startuml
!include ../_template_styles.puml
' PRACTICE: SOCIAL MEDIA ARCHITECTURE OPTIONS - Mixed layout for PPTX
top to bottom direction

rectangle "ACCESS PATTERNS" #FFFFFF {
    component "**User profile**\n<size:10>user_id -> KV</size>" as AP1 <<Primary>>
    component "**Posts by user**\n<size:10>user_id -> list</size>" as AP2 <<Primary>>
    component "**Likes by post**\n<size:10>post_id -> list</size>" as AP3 <<Primary>>
    component "**Trending**\n<size:10>aggregation</size>" as AP4 <<Primary>>
    AP1 -[hidden]right- AP2
    AP2 -[hidden]right- AP3
    AP3 -[hidden]right- AP4
}

rectangle "SQL OPTION" #FFFFFF {
    database "**Users**\n<size:10>user_id</size>" as USQL <<Schema>>
    database "**Posts**\n<size:10>user_id</size>" as PSQL <<Schema>>
    database "**Likes**\n<size:10>post_id</size>" as LSQL <<Schema>>
    component "**Join-heavy**\n<size:10>Cross-partition</size>" as SQLJOIN <<Failure>>
    USQL -[hidden]right- PSQL
    PSQL -[hidden]right- LSQL
}

rectangle "NoSQL OPTION" #FFFFFF {
    database "**Users+Posts**\n<size:10>Co-locate</size>" as UNOSQL <<Schema>>
    database "**Likes**\n<size:10>post_id</size>" as LNOSQL <<Schema>>
    component "**Single-partition**\n<size:10>Low-latency</size>" as NOSQLFAST <<success>>
    UNOSQL -[hidden]right- LNOSQL
}

database "**Aggregate**\n<size:10>Trending</size>" as AGG <<Schema>>

AP1 -down[#5C6BC0,thickness=2]-> USQL
AP1 -down[#5C6BC0,thickness=2]-> UNOSQL
AP2 -down[#5C6BC0,thickness=2]-> PSQL
AP2 -down[#5C6BC0,thickness=2]-> UNOSQL
AP3 -down[#5C6BC0,thickness=2]-> LSQL
AP3 -down[#5C6BC0,thickness=2]-> LNOSQL
AP4 -down[#5C6BC0,thickness=2]-> AGG
USQL -down[#D32F2F,thickness=2]-> SQLJOIN
PSQL -down[#D32F2F,thickness=2]-> SQLJOIN
UNOSQL -down[#00897B,thickness=2]-> NOSQLFAST
LNOSQL -down[#00897B,thickness=2]-> NOSQLFAST

@enduml
