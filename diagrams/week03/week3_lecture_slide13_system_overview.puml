@startuml
!include ../_template_styles.puml
' PARALLEL PIPELINE OVERVIEW (MAPREDUCE) - Mixed layout for PPTX
top to bottom direction

database "**Input**\n<size:10>Chunks</size>" as INP <<Schema>>

component "**Split**\n<size:10>Partition</size>" as SPLIT <<Control>>

rectangle "MAP PHASE" #FFFFFF {
    component "**W1**\n<size:10>Map</size>" as W1 <<Task>>
    component "**W2**\n<size:10>Map</size>" as W2 <<Task>>
    component "**W3**\n<size:10>Map</size>" as W3 <<Task>>
    W1 -[hidden]down- W2
    W2 -[hidden]down- W3
}

component "**Shuffle**\n<size:10>Group by key</size>" as SORT_XFER <<Control>>

rectangle "REDUCE PHASE" #FFFFFF {
    component "**R1**\n<size:10>Aggregate</size>" as R1 <<Task>>
    component "**R2**\n<size:10>Aggregate</size>" as R2 <<Task>>
    R1 -[hidden]down- R2
}

database "**Result**\n<size:10>Output</size>" as OUT <<Schema>>

INP -right[#5C6BC0,thickness=2]-> SPLIT
SPLIT -right[#5C6BC0,thickness=2]-> W1 : <color:#3949AB>c1</color>
SPLIT -right[#5C6BC0,thickness=2]-> W2 : <color:#3949AB>c2</color>
SPLIT -right[#5C6BC0,thickness=2]-> W3 : <color:#3949AB>c3</color>
W1 -right[#00897B,thickness=2]-> SORT_XFER
W2 -right[#00897B,thickness=2]-> SORT_XFER
W3 -right[#00897B,thickness=2]-> SORT_XFER
SORT_XFER -right[#5C6BC0,thickness=2]-> R1 : <color:#3949AB>keys A</color>
SORT_XFER -right[#5C6BC0,thickness=2]-> R2 : <color:#3949AB>keys B</color>
R1 -right[#00897B,thickness=2]-> OUT
R2 -right[#00897B,thickness=2]-> OUT

@enduml
