@startuml
'=================================================
' EXECUTION FLOW: TRIGGER TO COMMIT - Mixed layout for PPTX
'=================================================

!include ../_template_styles.puml

top to bottom direction

component "**Schedule**\n<size:10>Trigger job</size>" as TRIGGER1 <<Control>>

component "**Read source**\n<size:10>WHERE ts > watermark</size>" as READ1 <<Task>>

component "**Transform**\n<size:10>Dedup / cast</size>" as TRANSFORM_STEP <<Task>>

component "**Write target**\n<size:10>MERGE</size>" as WRITE1 <<Task>>

database "**Control**\n<size:10>watermark</size>" as STATE1 <<Schema>>

TRIGGER1 -right-> READ1 : "1"
READ1 -right-> TRANSFORM_STEP : "2"
TRANSFORM_STEP -right-> WRITE1 : "3"
WRITE1 -down-> STATE1 : "4 update"
STATE1 -up-> READ1 : "get watermark"

@enduml
