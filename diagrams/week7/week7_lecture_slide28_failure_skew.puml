@startuml
'=================================================
' Week 7: Failure / Edge Case — Data skew (hot key → OOM)
'=================================================

top to bottom direction
skinparam linetype ortho
skinparam shadowing false
skinparam roundcorner 8
skinparam defaultFontName "Segoe UI", "Helvetica", sans-serif
skinparam defaultFontSize 16
skinparam defaultFontColor #2C3E50
skinparam component { BackgroundColor #FFFFFF; BorderColor #78909C }
skinparam database { BackgroundColor #ECEFF1; BorderColor #546E7A }
skinparam arrow { Color #607D8B }

component "**Partition by hash(key)**" as PART
component "**R1**\n<size:10>balanced</size>" as R1 <<Tool>>
component "**R2**\n<size:10>balanced</size>" as R2 <<Tool>>
component "**R3 (HOT)**\n<size:10>one key, 800M values</size>" as R3 <<Tool>>
component "**OOM / Timeout**" as FAIL

database "**Done**" as D1
database "**Done**" as D2

PART --> R1
PART --> R2
PART --> R3 : "hot key\nall values"
R1 --> D1
R2 --> D2
R3 --> FAIL

note right of R3
  **Skew:** One key has
  majority of data
  (e.g. bot user_id).
end note

note bottom of FAIL
  **Mitigation:** Salting,
  combiner, custom partitioner
end note

@enduml
