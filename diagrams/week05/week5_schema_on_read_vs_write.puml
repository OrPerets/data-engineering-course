@startuml
'=================================================
' SCHEMA-ON-READ vs SCHEMA-ON-WRITE
' Two flows: validate on load vs apply at query
'=================================================

!include ../_template_styles.puml

left to right direction

database "**Load**\n<size:10>Validate + type</size>" as L1 <<Control>>
component "**Bad row**\n<size:10>Fail batch</size>" as R1 <<Failure>>
database "**DWH**\n<size:10>Typed</size>" as DWH <<Control>>
L1 -right-> DWH : <size:10>valid</size>
L1 -down-> R1 : <size:10>invalid</size>

database "**Load raw**\n<size:10>Parquet, JSON</size>" as L2 <<Task>>
component "**Query**\n<size:10>Apply schema</size>" as Q2 <<Task>>
database "**DLQ**\n<size:10>Invalid</size>" as DLQ <<Failure>>
database "**Lake**\n<size:10>Raw + processed</size>" as LAKE <<Task>>
L2 -right-> Q2
Q2 -right-> LAKE : <size:10>valid</size>
Q2 -down-> DLQ : <size:10>invalid</size>

L1 -[hidden]right- L2
DWH -[hidden]right- LAKE

@enduml
