@startuml
'=================================================
' Week 8: TF-IDF — Failure: Stop-word hot reducer (Job 2)
'=================================================

top to bottom direction
skinparam linetype ortho
skinparam shadowing false
skinparam roundcorner 8
skinparam defaultFontName "Segoe UI", "Helvetica", sans-serif
skinparam defaultFontSize 16
skinparam defaultFontColor #2C3E50
skinparam rectangle { BackgroundColor #F8F9FA; BorderColor #90A4AE; BorderThickness 2 }
skinparam component { BackgroundColor #FFFFFF; BorderColor #78909C; BorderThickness 1.5 }
skinparam database { BackgroundColor #ECEFF1; BorderColor #546E7A }
skinparam arrow { Color #607D8B; Thickness 1.5 }

rectangle "JOB 2 MAP" #F8F9FA {
    component "**Map**\nemit (term, doc_id)" as MAP
}

rectangle "SHUFFLE (by term)" #F8F9FA {
    component "**Partition**\nhash(term) mod R" as PART
}

rectangle "REDUCERS" #F8F9FA {
    component "**Reducer 0**\n\"the\" → [d1..dN]\n<size:10>HOT: N values</size>" as R0
    component "**Reducer 1**\n\"data\" → [...]" as R1
    component "**Reducer 2**\n\"eng\" → [...]" as R2
}

MAP --> PART
PART --> R0 : "(\"the\", doc_id) × N"
PART --> R1
PART --> R2

note bottom of R0 : **Failure:** OOM or timeout when N = millions. Mitigation: stop-word list in Map.

@enduml
