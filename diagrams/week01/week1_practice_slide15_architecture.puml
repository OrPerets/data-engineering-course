@startuml
!include ../_template_styles.puml
' NEWS PLATFORM - mixed layout
top to bottom direction

package "SOURCES" as P_SRC #FFFFFF {
    database "**News**\n<size:12>1K sites RSS</size>" as SOURCES <<Primary>>
    storage "**Clicks**\n<size:12>500K/day</size>" as CLICKS <<Primary>>
    SOURCES -[hidden]- CLICKS
}

package "INGESTION" as P_ING #FFFFFF {
    component "**Articles**\n<size:11>10K/day Pull</size>" as INGEST_ART <<Control>>
    component "**Clicks**\n<size:11>RT Stream</size>" as INGEST_CLICK <<Control>>
    INGEST_ART -[hidden]- INGEST_CLICK
}

package "STORAGE" as P_STO #FFFFFF {
    database "**Articles**\n<size:12>50M 515GB</size>" as RAW_ART <<Schema>>
    database "**Clicks**\n<size:12>200M 8.8GB</size>" as RAW_CLICK <<Schema>>
    RAW_ART -[hidden]- RAW_CLICK
}

package "PROCESSING" as P_PROC #FFFFFF {
    component "**Batch**\n<size:11>Daily Spark</size>" as BATCH <<Task>>
    component "**Stream**\n<size:11>5m windows</size>" as STREAM <<Task>>
    BATCH -[hidden]- STREAM
}

package "ANALYTICS" as P_ANAL #FFFFFF {
    database "**Warehouse**\n<size:12>Star schema</size>" as WAREHOUSE <<Schema>>
    cloud "**Trending**\n<size:12>RT API</size>" as TRENDING <<Control>>
    WAREHOUSE -[hidden]- TRENDING
}

package "CONSUMPTION" as P_CONS #FFFFFF {
    component "**Analytics**\n<size:11>BI tools</size>" as DASHBOARD <<Primary>>
    component "**App**\n<size:11>Mobile/Web</size>" as APP <<Task>>
    DASHBOARD -[hidden]- APP
}

SOURCES -down[#1565C0,thickness=2]-> INGEST_ART : <color:#3949AB><b>batch</b></color>
CLICKS -down[#FF6F00,thickness=2]-> INGEST_CLICK : <color:#3949AB><b>stream</b></color>

INGEST_ART -right[#1565C0,thickness=2]-> RAW_ART : <color:#3949AB>Parquet</color>
INGEST_CLICK -right[#FF6F00,thickness=2]-> RAW_CLICK : <color:#3949AB>Avro</color>

RAW_ART -down[#5C6BC0,thickness=2]-> BATCH : <color:#3949AB><b>daily</b></color>
RAW_CLICK -down[#00897B,thickness=2]-> STREAM : <color:#3949AB><b>RT</b></color>

BATCH -right[#5C6BC0,thickness=2]-> WAREHOUSE : <color:#3949AB>SQL</color>
STREAM -right[#00897B,thickness=2]-> TRENDING : <color:#3949AB>top-N</color>

WAREHOUSE -down[#1565C0,thickness=2]-> DASHBOARD : <color:#3949AB><b>BI</b></color>
TRENDING -down[#00897B,thickness=2]-> APP : <color:#3949AB><b>REST</b></color>

@enduml
