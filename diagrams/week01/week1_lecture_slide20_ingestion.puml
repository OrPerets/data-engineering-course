@startuml
!include ../_template_styles.puml
' INGESTION PIPELINE - mixed layout
left to right direction

storage "**S3 Logs**\n<size:12>JSON 5GB</size>" as S3 <<Primary>>

component "**1. Read**\n<size:11>Download</size>" as READ <<Control>>

component "**2. Parse**\n<size:11>Extract events</size>" as PARSE <<Task>>

component "**3. Validate**\n<size:11>Check schema</size>" as VALIDATE <<Task>>

component "**4. Write**\n<size:11>Compress</size>" as WRITE <<Task>>

database "**Raw Storage**\n<size:12>10M events</size>\n<size:12>5GB Parquet</size>" as RAW <<Schema>>

S3 -right[#1565C0,thickness=2]-> READ : <color:#3949AB><b>5GB</b></color>
READ -down[#1565C0,thickness=2]-> PARSE : <color:#3949AB>JSON</color>
PARSE -right[#00897B,thickness=2]-> VALIDATE : <color:#3949AB>events</color>
VALIDATE -down[#00897B,thickness=2]-> WRITE : <color:#3949AB>OK</color>
WRITE -right[#5C6BC0,thickness=2]-> RAW : <color:#3949AB><b>Parquet</b></color>

@enduml
