@startuml
!include ../_template_styles.puml
' FAILURE PROPAGATION â€” mixed layout
top to bottom direction

storage "**Input**\n<size:12>Raw events</size>" as INPUT

component "**Step 1**\n<size:11>Ingestion</size>" as STEP1 <<success>>
database "**Raw**\n<size:12>5 GB OK</size>" as RAW <<up>>

component "**Step 2**\n<size:11>Transform</size>\n<size:11><b>OOM error</b></size>" as STEP2 <<failure>>
database "**Partial**\n<size:12>2.5 GB</size>\n<size:12>incomplete</size>" as PARTIAL <<down>>

component "**Step 3**\n<size:11>Aggregate</size>\n<size:11>waiting</size>" as STEP3 <<down>>

component "**Step 4**\n<size:11>Load</size>\n<size:11>waiting</size>" as STEP4 <<down>>

database "**Output**\n<size:12>Blocked</size>" as OUTPUT <<down>>

INPUT -left[#00897B,thickness=2]-> STEP1 : <color:#3949AB><b>ingest</b></color>
STEP1 -down[#00897B,thickness=2]-> RAW : <color:#3949AB><b>saved</b></color>
RAW -down[#1565C0,thickness=2]-> STEP2 : <color:#3949AB>read</color>

STEP2 -left[#D32F2F,thickness=2]-> PARTIAL : <color:#3949AB><b>crash</b></color>
STEP2 -down[#D32F2F,thickness=2,dashed]-> STEP3 : <color:#3949AB>blocked</color>
STEP3 -down[#D32F2F,thickness=2,dashed]-> STEP4 : <color:#3949AB>blocked</color>
STEP4 -right[#D32F2F,thickness=2,dashed]-> OUTPUT : <color:#3949AB>no load</color>

@enduml
